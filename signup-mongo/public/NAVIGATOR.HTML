<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StartupNavigator Registration</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="NAVIGATOR.CSS">
</head>
<body>
    <div class="nav">
        <ul>
         <li id="signin"  onclick="window.location.href = 'signin.html'">Sign in</li>
         <li id="resource" onclick="window.location.href='home.html'">Resource</li>
         <li id="upspark" onclick="window.location.href='home.html'">UPSPARK</li>
         <li id="aboutus">About us</li>
         <li id="signup" onclick="window.location.href = 'signup.html'">Sign up</li>
        </ul>
     </div>
    <div class="container">
        <!-- <h2>Create Your StartupNavigator Account</h2> -->
        <b><p class="description">Start your entrepreneurial journey with personalized guidance and startup ideas tailored to you.</p>
        </b>
       <form id="navigatorForm">
    <label>Available funding to initiate </label>
    <input id="fundingInput" type="number" placeholder="Enter the funds" required>

    <div class="category-section">
        <label>Select Your Main Business Domains</label>
        <div class="category-list">
            <!-- domain checkboxes -->
            <div class="category-option"><label><input type="checkbox" name="domain" value="ai"> ai</label></div>
            <div class="category-option"><label><input type="checkbox" name="domain" value="agritech"> agritech</label></div>
            <!-- Add other categories as needed -->
        </div>
    </div>

    <button class="submit-btn" type="submit">Agree & Register</button>
</form>

<!-- Display results here -->
<div id="results" style="margin-top: 30px;">
  <h3>Recommended Startups:</h3>
  <div id="startupList"></div>
  <div id="result"></div>

</div>

<script>
  window.onload = function () {
    const user = localStorage.getItem('loggedInUser');
    if (!user) {
      alert("⚠️ You must be signed in to access this page.");
      window.location.href = 'signin.html';
    }
  };

  document.getElementById('navigatorForm').addEventListener('submit', async function (e) {
    e.preventDefault();

    const funding = parseInt(document.getElementById('fundingInput').value);
    const domains = Array.from(document.querySelectorAll('input[name="domain"]:checked'))
                         .map(cb => cb.value.toLowerCase());

    const response = await fetch('/filter-startups', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ funding, domains })
    });

    const startups = await response.json();

    const list = document.getElementById('startupList');
    list.innerHTML = ''; // Clear previous results

    if (startups.length === 0) {
      list.innerHTML = '<p>No matching startups found.</p>';
    } else {
      startups.forEach(s => {
        const div = document.createElement('div');
        div.className = 'startup-box';
        div.innerHTML = `
          <h4>${s.name}</h4>
          <p>${s.description}</p>
          <p><b>Growth:</b> ${s.growth_year1} → ${s.growth_year2} → ${s.growth_year3}</p>
        `;
        list.appendChild(div);
      });
    }
  });
  function submitForm() {
  const funding = document.querySelector('input[type="number"]').value;
  const domains = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);

  fetch('http://localhost:3001/startups', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ funding, domains })
  })
  .then(response => response.json())
  .then(data => {
    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML = ""; // clear previous

    if (data.length === 0) {
      resultDiv.innerHTML = "<p>No matching startups found.</p>";
    } else {
      data.forEach(startup => {
        resultDiv.innerHTML += `<p><strong>${startup.name}</strong> - ${startup.domain} - ₹${startup.funding}</p>`;
      });
    }
  })
  .catch(err => console.error("Error:", err));
}
</script>

</body>
</html>